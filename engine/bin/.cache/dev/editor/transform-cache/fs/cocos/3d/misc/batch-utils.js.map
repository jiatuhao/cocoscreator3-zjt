{"version":3,"sources":["file:///Applications/CocosCreator/Creator/3.0.0/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/3d/misc/batch-utils.ts"],"names":["checkMaterialisSame","comp1","comp2","matNum","sharedMaterials","length","i","getRenderMaterial","BatchingUtility","batchStaticModel","staticModelRoot","batchedRoot","models","getComponentsInChildren","MeshRenderer","console","error","mesh","validateMergingMesh","node","name","batchedMesh","Mesh","worldMat","Mat4","rootWorldMatInv","getWorldMatrix","invert","comp","multiply","merge","enabled","batchedModel","addComponent","unbatchStaticModel","getComponent","destroy"],"mappings":"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"}