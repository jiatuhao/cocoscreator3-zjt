{"version":3,"sources":["file:///Applications/CocosCreator/Creator/3.0.0/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/core/renderer/scene/model.ts"],"names":["AttrPool","ObjectPool","PoolType","ATTRIBUTE","_","obj","Attribute","m4_1","Mat4","_subModelPool","Pool","SubModel","shadowMapPatches","name","value","ModelType","uploadMat4AsVec4x3","mat","v1","v2","v3","m00","m01","m02","m12","m04","m05","m06","m13","m08","m09","m10","m14","lightmapSamplerHash","Filter","LINEAR","NONE","Address","CLAMP","lightmapSamplerWithMipHash","Model","subModels","_subModels","inited","_inited","worldBounds","_worldBounds","modelBounds","_modelBounds","localBuffer","_localBuffer","updateStamp","_updateStamp","isInstancingEnabled","_instMatWorldIdx","receiveShadow","ModelPool","get","_handle","ModelView","RECEIVE_SHADOW","val","set","onMacroPatchesStateChanged","castShadow","CAST_SHADOW","handle","node","_node","n","NODE","transform","_transform","TRANSFORM","visFlags","VIS_FLAGS","enabled","ENABLED","constructor","type","DEFAULT","scene","isDynamicBatching","instancedAttributes","buffer","views","attributes","_device","_descriptorSetCount","_transformUpdated","NULL_HANDLE","_hWorldBounds","_localData","Float32Array","UBOLocal","COUNT","_lightmap","_lightmapUVParam","Vec4","legacyCC","director","root","device","initialize","alloc","hSubModelArray","SubModelArrayPool","hInstancedAttrArray","AttributeArrayPool","INSTANCED_ATTR_ARRAY","SUB_MODEL_ARRAY","Layers","Enum","destroy","i","length","subModel","free","hOldBuffer","INSTANCED_BUFFER","RawBufferPool","hAttrArray","AABBPool","attachToScene","detachFromScene","updateTransform","stamp","hasChangedFlags","_dirtyFlags","updateWorldTransform","_mat","_pos","_rot","_scale","setVec3","AABBView","CENTER","center","HALF_EXTENSION","halfExtents","updateWorldBound","updateUBOs","update","worldMatrix","idx","attrs","toArray","MAT_WORLD_OFFSET","inverseTranspose","MAT_WORLD_IT_OFFSET","createBoundingShape","minPos","maxPos","AABB","fromPoints","create","clone","WORLD_BOUNDS","initSubModel","subMeshData","isNewSubModel","passes","getMacroPatches","initPlanarShadowShader","_updateAttributesAndBinding","assign","setSubModelMesh","subMesh","setSubModelMaterial","onGlobalPipelineStateChanged","onPipelineStateChanged","updateLightingmap","texture","uvParam","LIGHTINGMAP_UVPARAM","builtinResMgr","gfxTexture","getGFXTexture","sampler","samplerLib","getSampler","mipmaps","descriptorSet","bindTexture","UNIFORM_LIGHTMAP_TEXTURE_BINDING","bindSampler","subModelIndex","_initLocalDescriptors","_updateLocalDescriptors","shader","ShaderPool","SubModelPool","SubModelView","SHADER_0","_updateInstancedAttributes","_getInstancedAttributeIndex","pass","hasFeature","Feature","INSTANCED_ARRAYS","size","j","attribute","isInstanced","FormatInfos","format","hBuffer","getBuffer","Uint8Array","offset","hAttr","attr","isNormalized","location","push","info","count","batchingScheme","BatchingSchemes","INSTANCING","InstancedBuffer","INST_MAT_WORLD","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","SIZE","bindBuffer","BINDING"],"mappings":"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"}