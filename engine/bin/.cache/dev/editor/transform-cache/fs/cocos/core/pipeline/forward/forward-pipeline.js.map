{"version":3,"sources":["file:///Applications/CocosCreator/Creator/3.0.0/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/core/pipeline/forward/forward-pipeline.ts"],"names":["matShadowView","Mat4","matShadowViewProj","vec3_center","Vec3","_samplerInfo","Filter","LINEAR","NONE","Address","CLAMP","ForwardPipeline","RenderTextureConfig","MaterialConfig","RenderPipeline","fog","Fog","ambient","Ambient","skybox","Skybox","shadows","Shadows","renderObjects","shadowObjects","shadowFrameBufferMap","Map","_isHDR","_shadingScale","_fpScale","_renderPasses","_globalUBO","Float32Array","UBOGlobal","COUNT","_cameraUBO","UBOCamera","_shadowUBO","UBOShadow","isHDR","val","defaultGlobalUBOData","EXPOSURE_OFFSET","shadingScale","fpScale","shadowUBO","initialize","info","_flows","length","shadowFlow","ShadowFlow","initInfo","push","forwardFlow","ForwardFlow","activate","_macros","_activeRenderer","render","cameras","_commandBuffers","begin","updateGlobalUBO","i","camera","scene","updateCameraUBO","j","end","_device","queue","submit","getRenderPass","clearFlags","renderPass","get","device","colorAttachment","ColorAttachment","depthStencilAttachment","DepthStencilAttachment","format","colorFormat","depthStencilFormat","stencilStoreOp","StoreOp","DISCARD","depthStoreOp","ClearFlag","COLOR","SKYBOX_FLAG","loadOp","LoadOp","LOAD","beginLayout","TextureLayout","PRESENT_SRC","DEPTH_STENCIL","DEPTH","depthLoadOp","STENCIL","stencilLoadOp","DEPTH_STENCIL_ATTACHMENT_OPTIMAL","renderPassInfo","RenderPassInfo","createRenderPass","set","_descriptorSet","update","root","legacyCC","director","fv","shadingWidth","Math","floor","width","shadingHeight","height","TIME_OFFSET","cumulativeTime","frameTime","getTotalFrames","SCREEN_SIZE_OFFSET","NATIVE_SIZE_OFFSET","updateBuffer","getBuffer","BINDING","commandBuffer","globalUBO","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","SIZE","bindBuffer","cameraUBO","shadowMapSamplerHash","shadowMapSampler","samplerLib","getSampler","bindSampler","UNIFORM_SHADOWMAP_BINDING","bindTexture","builtinResMgr","getGFXTexture","UNIFORM_SPOT_LIGHTING_MAP_TEXTURE_BINDING","macros","CC_USE_HDR","CC_SUPPORT_FLOAT_TEXTURE","hasFeature","Feature","TEXTURE_FLOAT","updateShadowUBO","mainLight","shadowInfo","enabled","type","ShadowType","ShadowMap","has","colorTextures","shadowCameraView","x","y","far","autoAdapt","node","getWorldRotation","direction","radius","sphere","aspect","halfFar","distance","center","min","COEFFICIENT_OF_EXPANSION","MAX_FAR","getWorldMatrix","orthoSize","invert","projectionSignY","screenSpaceSignY","UVSpaceSignY","ortho","near","clipSpaceMinZ","multiply","toArray","MAT_LIGHT_VIEW_PROJ_OFFSET","SHADOW_INFO_OFFSET","size","pcf","bias","Planar","Color","shadowColor","SHADOW_COLOR_OFFSET","getScene","renderScene","cv","exposure","SCREEN_SCALE_OFFSET","MAIN_LIT_DIR_OFFSET","color","MAIN_LIT_COLOR_OFFSET","useColorTemperature","colorTempRGB","colorTemperatureRGB","z","illuminance","UNIT_Z","Vec4","ZERO","skyColor","colorArray","skyIllum","AMBIENT_SKY_OFFSET","albedoArray","AMBIENT_GROUND_OFFSET","matView","MAT_VIEW_OFFSET","worldMatrix","MAT_VIEW_INV_OFFSET","matProj","MAT_PROJ_OFFSET","matProjInv","MAT_PROJ_INV_OFFSET","matViewProj","MAT_VIEW_PROJ_OFFSET","matViewProjInv","MAT_VIEW_PROJ_INV_OFFSET","position","CAMERA_POS_OFFSET","window","hasOffScreenAttachments","GLOBAL_FOG_COLOR_OFFSET","GLOBAL_FOG_BASE_OFFSET","fogStart","fogEnd","fogDensity","GLOBAL_FOG_ADD_OFFSET","fogTop","fogRange","fogAtten","destroyUBOs","destroy","getTexture","rpIter","values","rpRes","next","done","value","serializable"],"mappings":"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"}