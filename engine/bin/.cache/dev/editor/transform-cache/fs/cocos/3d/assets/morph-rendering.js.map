{"version":3,"sources":["file:///Applications/CocosCreator/Creator/3.0.0/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/3d/assets/morph-rendering.ts"],"names":["preferCpuComputing","StdMorphRendering","constructor","mesh","gfxDevice","_mesh","_subMeshRenderings","struct","morph","nSubMeshes","primitives","length","Array","fill","iSubMesh","subMeshMorph","subMeshMorphs","targets","UBOMorph","MAX_MORPH_TARGET_COUNT","CpuComputing","GpuComputing","createInstance","subMeshInstances","setWeights","subMeshIndex","weights","requiredPatches","subMeshRenderingInstance","undefined","patches","name","value","attributes","includes","AttributeName","ATTR_POSITION","push","ATTR_NORMAL","ATTR_TANGENT","adaptPipelineState","descriptorSet","destroy","subMeshInstance","_gfxDevice","_subMeshMorph","_textureInfo","_attributes","_verticesCount","enableVertexId","nVertices","vertexBundles","vertexBundelIndices","view","count","nTargets","vec4Required","vec4TextureFactory","createVec4TextureFactory","width","height","map","attributeName","attributeIndex","vec4Tex","create","valueView","forEach","morphTarget","morphTargetIndex","displacementsView","displacements","Float32Array","data","buffer","byteOffset","offset","displacementsOffset","iVertex","updatePixels","morphTexture","attribute","morphUniforms","MorphUniforms","setMorphTextureInfo","setVerticesCount","commit","binding","UNIFORM_POSITION_MORPH_TEXTURE_BINDING","UNIFORM_NORMAL_MORPH_TEXTURE_BINDING","UNIFORM_TANGENT_MORPH_TEXTURE_BINDING","bindSampler","sampler","bindTexture","texture","bindBuffer","BINDING","update","attributeDisplacement","CpuComputingRenderingInstance","owner","_owner","_morphUniforms","attributeMorph","iAttribute","myAttribute","iTarget","targetDisplacements","weight","targetCount","_targetCount","_localBuffer","_remoteBuffer","DataView","ArrayBuffer","SIZE","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","iWeight","setFloat32","OFFSET_OF_WEIGHTS","legacyCC","sys","isLittleEndian","OFFSET_OF_DISPLACEMENT_TEXTURE_WIDTH","OFFSET_OF_DISPLACEMENT_TEXTURE_HEIGHT","OFFSET_OF_VERTICES_COUNT","vec4Capacity","hasFeatureFloatTexture","hasFeature","Feature","TEXTURE_FLOAT","pixelRequired","pixelFormat","pixelBytes","UpdateViewConstructor","Texture2D","PixelFormat","RGBA32F","RGBA8888","Uint8Array","bestSizeToHavePixels","arrayBuffer","updateView","image","ImageAsset","_data","_compressed","format","textureAsset","setFilters","Filter","NEAREST","setMipFilter","NONE","setWrapMode","WrapMode","CLAMP_TO_EDGE","getGFXTexture","samplerLib","getSampler","getSamplerHash","uploadData","renderingSubMeshes","enableVertexIdChannel","nPixels","aligned","epxSum","h","w"],"mappings":"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"}