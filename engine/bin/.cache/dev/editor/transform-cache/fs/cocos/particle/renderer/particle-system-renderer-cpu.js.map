{"version":3,"sources":["file:///Applications/CocosCreator/Creator/3.0.0/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/particle/renderer/particle-system-renderer-cpu.ts"],"names":["_tempAttribUV","Vec3","_tempWorldTrans","Mat4","_anim_module","_uvs","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","_vertex_attrs","Attribute","AttributeName","ATTR_POSITION","Format","RGB32F","ATTR_TEX_COORD","ATTR_TEX_COORD1","ATTR_TEX_COORD2","ATTR_COLOR","RGBA8","_vertex_attrs_stretch","ATTR_COLOR1","_vertex_attrs_mesh","ATTR_TEX_COORD3","ATTR_NORMAL","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererCPU","ParticleSystemRendererBase","constructor","info","_defines","_trailDefines","_frameTile_velLenScale","_defaultMat","_node_scale","_attrs","_particles","_defaultTrailMat","_updateList","Map","_animateList","_runAnimateList","Array","_fillDataFunc","_uScaleHandle","_uLenHandle","_inited","_model","Vec4","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","onInit","ps","RecyclePool","Particle","_setVertexAttrib","_setFillFunc","_initModuleList","_initModel","updateMaterialParams","updateTrailMaterial","setVertexAttributes","clear","reset","_particleSystem","_trailModule","updateRenderData","enabled","updateRenderMode","getFreeParticle","length","capacity","add","getDefaultTrailMaterial","setNewParticle","p","forEach","val","pm","enable","needUpdate","name","needAnimate","i","len","PARTICLE_MODULE_ORDER","push","enableModule","updateParticles","dt","node","getWorldMatrix","scaleSpace","Space","Local","getScale","World","getWorldScale","mat","getMaterialInstance","pass","passes","setUniform","value","key","update","_simulationSpace","trailModule","trailEnable","data","remainingLifetime","set","animatedVelocity","removeParticle","removeAt","velocity","y","gravityModifier","evaluate","startLifetime","randomSeed","copy","ultimateVelocity","animate","scaleAndAdd","position","idx","fi","textureModule","_textureAnimationModule","frameIndex","beforeRender","updateIA","getParticleCount","onMaterialModified","index","material","onRebuildPSO","setSubModelMaterial","_trailModel","_renderInfo","renderMode","RenderMode","Mesh","_fillMeshData","StrecthedBillboard","_fillStrecthedData","_fillNormalData","attrNum","z","size","rotation","color","_val","addParticleVertexData","j","x","_vertAttrs","slice","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","builtinResMgr","get","MaterialInstance","setProperty","getHandle","vlenScale","Billboard","velocityScale","w","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","Vec2","numTilesX","numTilesY","recompileShaders","updateMaterial","simulationSpace","space"],"mappings":"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"}