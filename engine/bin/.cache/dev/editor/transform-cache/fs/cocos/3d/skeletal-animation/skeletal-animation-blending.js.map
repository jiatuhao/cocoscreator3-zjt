{"version":3,"sources":["file:///Applications/CocosCreator/Creator/3.0.0/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/3d/skeletal-animation/skeletal-animation-blending.ts"],"names":["BlendStateBuffer","_nodeBlendStates","Map","_states","Set","ref","node","property","nodeBlendState","get","dirty","properties","set","propertyBlendState","PropertyBlendState","isVec3Property","Vec3","Quat","refCount","deRef","isEmptyNodeBlendState","delete","apply","forEach","position","scale","rotation","eulerAngles","t","s","r","anyChanged","weight","value","setRTS","state","onBlendFinished","bindState","add","unbindState","createBlendStateWriter","blendState","host","constants","blendFunction","additive3D","additiveQuat","isConstCacheValid","lastWeight","destroy","forTarget","enabled","markAsDirty","isQuatProperty","constructor","_node","zero","copy","scaleAndAdd","identity","slerp"],"mappings":"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"}