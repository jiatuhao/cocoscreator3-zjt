{"version":3,"sources":["file:///Applications/CocosCreator/Creator/3.0.0/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/core/pipeline/shadow/shadow-stage.ts"],"names":["colors","Color","ShadowStage","RenderStage","_shadowFrameBuffer","_renderArea","Rect","_light","setUsage","light","shadowFrameBuffer","destroy","_additiveShadowQueue","clear","clearFramebuffer","camera","w","clearColor","pipeline","_pipeline","cmdBuff","commandBuffers","renderPass","beginRenderPass","clearDepth","clearStencil","endRenderPass","render","shadowInfo","shadows","gatherLightPasses","vp","viewport","shadowMapSize","size","x","y","width","shadingScale","height","device","bindDescriptorSet","SetIndex","GLOBAL","descriptorSet","recordCommandBuffer","activate","flow","RenderShadowMapBatchedQueue","initInfo","name","priority","ForwardStagePriority","FORWARD","tag"],"mappings":"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"}