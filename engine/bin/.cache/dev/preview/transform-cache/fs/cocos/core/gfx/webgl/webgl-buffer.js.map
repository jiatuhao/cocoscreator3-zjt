{"version":3,"sources":["../../../../../../../../../../cocos/core/gfx/webgl/webgl-buffer.ts"],"names":["Buffer","IndirectBuffer","BufferUsageBit","BufferFlagBit","WebGLCmdFuncCreateBuffer","WebGLCmdFuncDestroyBuffer","WebGLCmdFuncResizeBuffer","WebGLCmdFuncUpdateBuffer","WebGLBuffer","_gpuBuffer","_gpuBufferView","_uniformBuffer","initialize","info","_isBufferView","buffer","_usage","usage","_memUsage","memUsage","_size","_stride","range","_count","_flags","flags","gpuBuffer","offset","size","Math","max","stride","INDIRECT","_indirectBuffer","BAKUP_BUFFER","_bakcupBuffer","Uint8Array","_device","memoryStatus","bufferSize","UNIFORM","vf32","indirects","glTarget","glBuffer","drawInfos","destroy","resize","console","warn","oldSize","oldView","set","update","buffSize","undefined","byteLength","view"],"mappings":"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"}