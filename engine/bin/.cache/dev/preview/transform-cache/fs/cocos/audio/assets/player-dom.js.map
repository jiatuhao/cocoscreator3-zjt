{"version":3,"sources":["../../../../../../../../../cocos/audio/assets/player-dom.ts"],"names":["clamp","AudioPlayer","PlayingState","legacyCC","createDomAudio","AudioManager","AudioManagerDom","discardOnePlayingIfNeeded","_playingAudios","length","maxAudioChannel","audioToDiscard","oldestOneShotIndex","findIndex","audio","HTMLAudioElement","splice","pause","src","shift","stop","AudioPlayerDOM","info","_volume","_loop","_nativeAudio","_cbRegistered","_remove_cb","_post_play","_on_gesture","_post_gesture","nativeAudio","game","canvas","removeEventListener","_state","PLAYING","_clip","emit","_manager","addPlaying","_interrupted","currentTime","promise","play","director","once","Director","EVENT_AFTER_UPDATE","then","volume","loop","addEventListener","STOPPED","removePlaying","_blocking","setCurrentTime","playOneShot","dom","errMsg","console","error","val","_duration","getCurrentTime","setVolume","immediate","getVolume","setLoop","getLoop","destroy"],"mappings":"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"}