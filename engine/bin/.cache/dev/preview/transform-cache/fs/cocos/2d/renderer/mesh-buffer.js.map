{"version":3,"sources":["../../../../../../../../../cocos/2d/renderer/mesh-buffer.ts"],"names":["BufferUsageBit","MemoryUsageBit","InputAssemblerInfo","BufferInfo","NULL_HANDLE","IAPool","getComponentPerVertex","MeshBuffer","_attributes","_vertexBuffers","_indexBuffer","batcher","vData","iData","byteStart","byteOffset","indicesStart","indicesOffset","vertexStart","vertexOffset","lastByteOffset","_iaInfo","_batcher","_dirty","_vertexFormatBytes","_initVDataCount","_initIDataCount","_outOfCallback","_hInputAssemblers","_nextFreeIAHandle","initialize","attrs","outOfCallback","formatBytes","Float32Array","BYTES_PER_ELEMENT","vbStride","vertexBuffers","length","push","device","createBuffer","VERTEX","TRANSFER_DST","HOST","DEVICE","ibStride","Uint16Array","indexBuffer","INDEX","attributes","_reallocBuffer","request","vertexCount","indicesCount","call","byteLength","indicesLength","reset","destroy","i","free","recordBatch","vCount","alloc","hIA","ia","get","firstIndex","indexCount","uploadBuffers","verticesData","buffer","indicesData","size","resize","update","_reallocVData","_reallocIData","copyOldData","oldVData","Uint8Array","newData","l","oldIData","OPACITY_OFFSET"],"mappings":"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"}