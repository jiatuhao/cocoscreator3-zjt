{"version":3,"sources":["../../../../../../../../../cocos/particle/renderer/particle-system-renderer-cpu.ts"],"names":["builtinResMgr","AttributeName","Format","Attribute","Mat4","Vec2","Vec3","Vec4","pseudoRandom","RecyclePool","MaterialInstance","RenderMode","Space","Particle","PARTICLE_MODULE_ORDER","ParticleSystemRendererBase","_tempAttribUV","_tempWorldTrans","_anim_module","_uvs","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","_vertex_attrs","ATTR_POSITION","RGB32F","ATTR_TEX_COORD","ATTR_TEX_COORD1","ATTR_TEX_COORD2","ATTR_COLOR","RGBA8","_vertex_attrs_stretch","ATTR_COLOR1","_vertex_attrs_mesh","ATTR_TEX_COORD3","ATTR_NORMAL","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererCPU","info","_defines","_trailDefines","_frameTile_velLenScale","_defaultMat","_node_scale","_attrs","_particles","_defaultTrailMat","_updateList","Map","_animateList","_runAnimateList","Array","_fillDataFunc","_uScaleHandle","_uLenHandle","_inited","_model","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","onInit","ps","_setVertexAttrib","_setFillFunc","_initModuleList","_initModel","updateMaterialParams","updateTrailMaterial","setVertexAttributes","clear","reset","_particleSystem","_trailModule","updateRenderData","enabled","updateRenderMode","getFreeParticle","length","capacity","add","getDefaultTrailMaterial","setNewParticle","p","forEach","val","pm","enable","needUpdate","name","needAnimate","i","len","push","enableModule","updateParticles","dt","node","getWorldMatrix","scaleSpace","Local","getScale","World","getWorldScale","mat","getMaterialInstance","pass","passes","setUniform","value","key","update","_simulationSpace","trailModule","trailEnable","data","remainingLifetime","set","animatedVelocity","removeParticle","removeAt","velocity","y","gravityModifier","evaluate","startLifetime","randomSeed","copy","ultimateVelocity","animate","scaleAndAdd","position","idx","fi","textureModule","_textureAnimationModule","frameIndex","beforeRender","updateIA","getParticleCount","onMaterialModified","index","material","onRebuildPSO","setSubModelMaterial","_trailModel","_renderInfo","renderMode","Mesh","_fillMeshData","StrecthedBillboard","_fillStrecthedData","_fillNormalData","attrNum","z","size","rotation","color","_val","addParticleVertexData","j","x","_vertAttrs","slice","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","get","setProperty","getHandle","vlenScale","Billboard","velocityScale","w","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","numTilesX","numTilesY","recompileShaders","updateMaterial","simulationSpace","space"],"mappings":"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"}