{"version":3,"sources":["../../../../../../../../../../cocos/core/pipeline/shadow/shadow-stage.ts"],"names":["ccclass","Color","Rect","RenderStage","ForwardStagePriority","RenderShadowMapBatchedQueue","SetIndex","colors","ShadowStage","_shadowFrameBuffer","_renderArea","_light","setUsage","light","shadowFrameBuffer","destroy","_additiveShadowQueue","clear","clearFramebuffer","camera","w","clearColor","pipeline","_pipeline","cmdBuff","commandBuffers","renderPass","beginRenderPass","clearDepth","clearStencil","endRenderPass","render","shadowInfo","shadows","gatherLightPasses","vp","viewport","shadowMapSize","size","x","y","width","shadingScale","height","device","bindDescriptorSet","GLOBAL","descriptorSet","recordCommandBuffer","activate","flow","initInfo","name","priority","FORWARD","tag"],"mappings":"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"}