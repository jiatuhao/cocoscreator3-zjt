{"version":3,"sources":["../../../../../../../../../cocos/physics/framework/physics-system.ts"],"names":["initPhysicsSystem","EDITOR","physics","game","config","cg","collisionGroups","Array","forEach","v","PhysicsGroup","name","index","Enum","update","oldIns","PhysicsSystem","instance","director","unregisterSystem","physicsWorld","destroy","sys","legacyCC","_instance","registerSystem","ID","Vec3","createPhysicsWorld","Director","System","PhysicsMaterial","RecyclePool","PhysicsRayResult","CollisionMatrix","selector","internal","_enable","value","_allowSleep","setAllowSleep","_maxSubSteps","_fixedTimeStep","_gravity","gravity","set","setGravity","_sleepThreshold","_autoSimulation","_material","id","raycastClosestResult","raycastResults","collisionMatrix","useNodeChains","_subStepCount","_accumulator","raycastOptions","group","mask","queryTrigger","maxDistance","raycastResultPool","physicsEngine","copy","allowSleep","fixedTimeStep","maxSubSteps","sleepThreshold","autoSimulation","defaultMaterial","friction","rollingFriction","spinningFriction","restitution","i","key","parseInt","on","_updateMaterial","setDefaultMaterial","postUpdate","deltaTime","GAME_VIEW","_executeInEditMode","syncSceneToPhysics","emit","EVENT_BEFORE_PHYSICS","step","emitEvents","syncAfterEvents","EVENT_AFTER_PHYSICS","resetAccumulator","time","raycast","worldRay","reset","length","raycastClosest","once","EVENT_INIT"],"mappings":"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"}