{"version":3,"sources":["../../../../../../../../../cocos/core/assets/image-asset.ts"],"names":["isImageBitmap","imageSource","legacyCC","sys","capabilities","imageBitmap","ImageBitmap","fetchImageSource","_data","isNativeImage","ALIPAY","XIAOMI","BAIDU","JSB","_compressed","HTMLImageElement","HTMLCanvasElement","_getGlobalDevice","director","root","device","ccclass","override","EDITOR","MINIGAME","TEST","Feature","Asset","PixelFormat","warnID","ImageAsset","_nativeData","value","HTMLElement","format","_format","reset","width","_width","height","_height","RGB_ETC1","RGBA_ASTC_12x12","RGB_A_PVRTC_2BPPV1","RGBA_ETC1","nativeUrl","tex","_tex","Texture2D","name","image","nativeAsset","_exportedExts","undefined","RGBA8888","loaded","data","_onDataComplete","complete","addEventListener","err","message","destroy","src","_setRawAsset","close","_serialize","targetExtensions","_native","extensionIndices","targetExtension","extensionFormat","split","i","extnames","indexOf","exportedExtensionID","push","fmt","join","w","h","_deserialize","fmtStr","extensionIDs","defaultExt","preferedExtensionIndex","Number","MAX_VALUE","ext","SupportTextureFormats","macro","SUPPORT_TEXTURE_FORMATS","extensionID","extFormat","parseInt","tmpExt","index","hasFeature","FORMAT_ASTC","FORMAT_PVRTC","FORMAT_ETC1","RGB_ETC2","RGBA_ETC2","FORMAT_ETC2","webp","emit"],"mappings":"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"}